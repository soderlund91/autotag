<div id="AutoTagConfigPage" data-role="page" class="page type-interior pluginConfigurationPage"
     data-require="emby-input,emby-button,emby-checkbox,emby-textarea"
     data-controller="__plugin/AutoTagJS">

    <style>
        .tag-row {
            background: var(--theme-background-level2);
            margin-bottom: 15px;
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-left: 5px solid #52B54B;
            transition: all 0.2s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .tag-header {
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
            color: var(--theme-text-primary);
            background: rgba(255, 255, 255, 0.03);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: background 0.2s;
        }

            .tag-header:hover {
                background: var(--theme-background-level3);
            }

        .tag-info {
            display: flex;
            align-items: center;
            flex-grow: 1;
        }

        .tag-title {
            font-size: 1.1em;
            font-weight: bold;
            margin: 0 15px;
            color: var(--theme-text-primary);
        }

        .tag-status {
            font-size: 0.8em;
            color: var(--theme-text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .tag-body {
            padding: 20px;
            display: none;
            border-top: 1px solid var(--line-color);
            color: var(--theme-text-primary);
            background: var(--theme-background-level1);
        }

        .url-list-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 15px;
        }

        .url-row {
            display: flex;
            align-items: center;
            gap: 10px;
            width: 100%;
        }

        .url-input-wrapper {
            flex-grow: 1;
        }

        .btn-icon-only {
            min-width: 40px !important;
            width: 40px !important;
            height: 40px !important;
            border-radius: 50% !important;
            padding: 0 !important;
            display: flex !important;
            align-items: center;
            justify-content: center;
            background: transparent !important;
            color: var(--theme-icon-color) !important;
            box-shadow: none !important;
        }

            .btn-icon-only:hover {
                background: rgba(255, 255, 255, 0.1) !important;
                color: #cc3333 !important;
            }

        .add-url-container {
            display: flex;
            align-items: center;
            margin-top: 5px;
        }

        .btn-add-url {
            font-size: 0.9em !important;
            background: transparent !important;
            border: 1px dashed var(--line-color) !important;
            color: var(--theme-text-secondary) !important;
            width: 100%;
            justify-content: center;
        }

            .btn-add-url:hover {
                background: var(--theme-background-level2) !important;
                color: var(--theme-text-primary) !important;
                border-color: #52B54B !important;
            }

        .tag-row.expanded .tag-body {
            display: block;
            animation: slideDown 0.3s ease-out;
        }

        .expand-icon {
            transition: transform 0.3s ease;
            color: var(--theme-icon-color);
        }

        .tag-row.expanded .expand-icon {
            transform: rotate(180deg);
        }

        .advanced-section {
            background: var(--theme-background-level2);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 5px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .advanced-header {
            padding: 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.03);
            color: var(--theme-text-primary);
        }

            .advanced-header:hover {
                background: rgba(255, 255, 255, 0.05);
            }

        .advanced-body {
            padding: 20px;
            display: none;
            border-top: 1px solid var(--line-color);
            color: var(--theme-text-primary);
            background: var(--theme-background-level1);
        }

        .advanced-section.expanded .advanced-body {
            display: block;
        }

        .advanced-section.expanded .expand-icon {
            transform: rotate(180deg);
        }

        .floating-actions {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 9999;
            display: flex;
            gap: 15px;
        }

        .fab-btn {
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
            height: 45px !important;
            border-radius: 25px !important;
            padding: 0 20px !important;
            white-space: nowrap;
        }

        .btn-save {
            background-color: #52B54B !important;
            color: #fff !important;
        }

        .btn-run {
            background-color: #00a4dc !important;
            color: #fff !important;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }


        .inspiration-container {
            text-align: center;
            margin: 20px 0 30px 0;
            border-bottom: 1px solid var(--line-color);
            padding-bottom: 20px;
        }

        .links-wrapper {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            margin-top: 10px;
        }

        .simple-link {
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            color: var(--theme-text-secondary) !important;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.2s ease;
            opacity: 0.8;
        }

            .simple-link:hover {
                color: var(--theme-text-primary) !important;
                opacity: 1;
                transform: scale(1.05);
            }

            .simple-link img {
                height: 20px;
                width: auto;
                vertical-align: middle;
            }

        .textMuted {
            color: var(--theme-text-secondary);
        }
    </style>

    <div class="content-primary">
        <div class="verticalSection">
            <h2 class="sectionTitle">Settings</h2>
            <p class="textMuted">Configure API keys and sources for automatic tagging.</p>

            <form class="AutoTagForm">
                <div class="inputContainer">
                    <input is="emby-input" type="text" id="txtTraktClientId" label="Trakt Client ID" />
                </div>
                <div class="inputContainer">
                    <input is="emby-input" type="text" id="txtMdblistApiKey" label="MDBList API Key" />
                </div>

                <div class="advanced-section" id="advancedSettings">
                    <div class="advanced-header">
                        <i class="md-icon expand-icon">expand_more</i>
                        <span style="margin-left: 10px; font-weight: bold;">Advanced Settings</span>
                    </div>
                    <div class="advanced-body">
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label>
                                <input is="emby-checkbox" type="checkbox" id="chkExtendedConsoleOutput" />
                                <span>Extended Log Output</span>
                            </label>
                            <div class="fieldDescription">Enable verbose logging for debugging purposes.</div>
                        </div>

                        <div class="checkboxContainer checkboxContainer-withDescription" style="margin-top: 15px;">
                            <label>
                                <input is="emby-checkbox" type="checkbox" id="chkDryRunMode" />
                                <span>Dry Run Mode</span>
                            </label>
                            <div class="fieldDescription">Simulate process without modifying database.</div>
                        </div>
                    </div>
                </div>

                <hr style="border-color: var(--line-color);" />

                <div class="inspiration-container">
                    <p class="textMuted" style="margin-bottom: 10px; font-size: 0.9em;">Looking for lists?</p>
                    <div class="links-wrapper">
                        <a href="https://trakt.tv/discover" target="_blank" class="simple-link">
                            <img src="https://i.ibb.co/xSMnN8NK/trakt-logo.png" alt="Trakt" /><span>Trakt</span>
                        </a>
                        <span style="color: var(--theme-text-secondary);">|</span>
                        <a href="https://mdblist.com/toplists/" target="_blank" class="simple-link">
                            <img src="https://i.ibb.co/7JWQDLLR/mdblist.png" alt="MDBList" /><span>MDBList</span>
                        </a>
                    </div>
                </div>

                <div class="sectionTitleContainer flex align-items-center" style="margin-bottom: 1em; margin-top: 2em;">
                    <h2 class="sectionTitle" style="margin-bottom:0;">Tag Sources</h2>
                    <button is="emby-button" type="button" id="btnAddTag" class="raised button-submit mb025" style="margin-left: auto;">
                        <span>+ Add New Source</span>
                    </button>
                </div>

                <div id="tagListContainer" class="verticalSection"></div>

                <br /><br /><br /><br /><br />

                <div class="floating-actions">
                    <button is="emby-button" type="submit" class="raised button-submit fab-btn btn-save">
                        <i class="md-icon" style="margin-right:5px;">save</i><span>Save Settings</span>
                    </button>
                    <button is="emby-button" type="button" id="btnRunSync" class="raised button-submit fab-btn btn-run">
                        <i class="md-icon" style="margin-right:5px;">play_arrow</i><span>Run Full Sync</span>
                    </button>
                </div>
            </form>
        </div>

        <div style="margin-top: 5em; padding-top: 2em; border-top: 1px solid var(--line-color); text-align: center; color: var(--theme-text-secondary);">
            <p style="margin-bottom: 10px; font-weight: bold;">AutoTag v1.3.0.0</p>
            <p style="font-size: 0.75em; opacity: 0.6; font-style: italic;">AutoTag is not affiliated with Trakt.tv or MDBList.</p>
        </div>
    </div>
</div>